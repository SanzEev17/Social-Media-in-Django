{% extends 'base.html' %}
{% block content %}
  <section class="h-100 gradient-custom-2">
    <div class="container py-5 h-100">
      <div class="row d-flex justify-content-center align-items-center h-100">
        <div class="col col-lg-9 col-xl-7">
          <div class="card">
            <div class="rounded-top text-white d-flex flex-row"
                 style="background-color: #000;
                        height:200px">
              <div class="ms-4 mt-5 d-flex flex-column" style="width: 150px;">
                <img src="{{ profile_data.profile_img.url }}"
                     alt="Generic placeholder image"
                     class="img-fluid img-thumbnail mt-4 mb-2"
                     style="width: 150px;
                            z-index: 1">
                <button type="button"
                        class="btn btn-outline-dark"
                        data-mdb-ripple-color="dark"
                        style="z-index: 1">Edit profile</button>
              </div>
              <div class="ms-3" style="margin-top: 130px;">
                <h5>{{ profile_data.user.first_name }} {{ profile_data.user.last_name }}</h5>
                <p>{{ profile_data.address }}</p>
              </div>
            </div>
            <div class="p-4 text-black" style="background-color: #f8f9fa;">
              <div class="d-flex justify-content-end text-center py-1">
              {% if profile_data.user != request.user %}
              {% if friends %}
                {% for friend_list in friends%}
                    {%for friend in friend_list.friends.all%}
                        {%if profile_data.user != friend%}
                            {% if friend_request_sent%}
                                {%for friend_request in friend_request_sent %}
                                <a class="btn btn-outline-primary me-2"
                                href="{% url 'cancel_friend_request' friend_request.id %}">
                                Cancel Request
                              </a>
                                {%endfor%}
                            {% elif friend_request_received%}
                                {%for friend_request in friend_request_received %}
                                <a class="btn btn-outline-primary me-2"
                                href="{% url 'accept_friend_request' friend_request.id %}">
                                  Accept Request
                              </a>
                                {%endfor%}
                            {%else%}
                            <a class="btn btn-outline-primary me-2"
                            href="{% url 'send_friend_request' profile_data.user %}">
                              Send Request
                          </a>
                            {%endif%}
                        {%endif%}
                    {%endfor%}
                {%endfor%}

              {% elif friend_request_sent%}
                {%for friend_request in friend_request_sent %}
                <a class="btn btn-outline-primary me-2"
                href="{% url 'cancel_friend_request' friend_request.id %}">
                Cancel Request
              </a>
                {%endfor%}
            {% elif friend_request_received%}
                {%for friend_request in friend_request_received %}
                <a class="btn btn-outline-primary me-2"
                href="{% url 'accept_friend_request' friend_request.id %}">
                  Accept Request
              </a>
                {%endfor%}
            {%else%}
            <a class="btn btn-outline-primary me-2"
            href="{% url 'send_friend_request' profile_data.user %}">
              Send Request
          </a>
            {%endif%}




                {% if friends or friend_request_sent or friend_request_received %}
                  {% for friend_list in friends %}
                  {% if friend_list.friends.all%}
                    {% for friend in friend_list.friends.all %}
                      {% if profile_data.user == friend %}
                        <a class="btn btn-outline-primary me-2"
                          href="{% url 'unfriend' profile_data.user %}">Unfriend
                        </a>
                      {%endif%}
                    {%endfor%}
                      {% elif friend_request_sent %}
                        {%for friend_request in friend_request_sent %}
                          <a class="btn btn-outline-primary me-2"
                            href="{% url 'cancel_friend_request' friend_request.id %}">
                            Cancel Request
                          </a>
                        {%endfor%}
                      {% elif friend_request_received %}
                        {%for friend_request in friend_request_received %}
                          <a class="btn btn-outline-primary me-2"
                            href="{% url 'accept_friend_request' friend_request.id %}">
                              Accept Request
                          </a>
                              Decline Request
                        {%endfor%}
                        {%else%}
                        <a class="btn btn-outline-primary me-2"
                          href="{% url 'send_friend_request' profile_data.user %}">
                            Send Request
                        </a>
                      {%endif%}
                  {%endfor%}
                  {%else%}
                        <a class="btn btn-outline-primary me-2"
                          href="{% url 'send_friend_request' profile_data.user %}">
                            Send Request
                        </a>
                {%endif%}

                
              {% endif %}
              </div>
            </div>
            <div class="d-flex justify-content-end text-center py-1">
              <div>
                <p class="mb-1 h5">253</p>
                <p class="small text-muted mb-0">Photos</p>
              </div>
              <div class="px-3">
                <p class="mb-1 h5">1026</p>
                <p class="small text-muted mb-0">Followers</p>
              </div>
              <div>
                <p class="mb-1 h5">478</p>
                <p class="small text-muted mb-0">Following</p>
              </div>
            </div>
          </div>
          <div class="card-body p-4 text-black">
            <div class="mb-5">
              <p class="lead fw-normal mb-1">About</p>
              <div class="p-4" style="background-color: #f8f9fa;">
                <p class="font-italic mb-1">Web Developer</p>
                <p class="font-italic mb-1">Lives in New York</p>
                <p class="font-italic mb-0">Photographer</p>
              </div>
            </div>
            <div class="d-flex justify-content-between align-items-center mb-4">
              <p class="lead fw-normal mb-0">Recent photos</p>
              <p class="mb-0">
                <a href="#!" class="text-muted">Show all</a>
              </p>
            </div>
            <div class="row g-2">
              <div class="col mb-2">
                <img src="https://mdbcdn.b-cdn.net/img/Photos/Lightbox/Original/img%20(112).webp"
                     alt="image 1"
                     class="w-100 rounded-3">
              </div>
              <div class="col mb-2">
                <img src="https://mdbcdn.b-cdn.net/img/Photos/Lightbox/Original/img%20(107).webp"
                     alt="image 1"
                     class="w-100 rounded-3">
              </div>
            </div>
            <div class="row g-2">
              <div class="col">
                <img src="https://mdbcdn.b-cdn.net/img/Photos/Lightbox/Original/img%20(108).webp"
                     alt="image 1"
                     class="w-100 rounded-3">
              </div>
              <div class="col">
                <img src="https://mdbcdn.b-cdn.net/img/Photos/Lightbox/Original/img%20(114).webp"
                     alt="image 1"
                     class="w-100 rounded-3">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}
